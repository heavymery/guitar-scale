(function(){for(var a,b=function(){},c="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profileEnd table time timeEnd timeStamp trace warn".split(" "),d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)})();String.prototype.format=function(){for(var a=this,b=0;b<arguments.length;b++)a=a.replace(RegExp("\\{"+b+"\\}","gi"),arguments[b]);return a};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};
Array.prototype.contains=function(a){for(var b in this)if(this.hasOwnProperty(b)&&this[b]===a)return!0;return!1};
var fretboard,fretboardZoomRate=1,selectedRootNote="C",selectedScaleInterval=[2,2,1,2,2,2];window.addEventListener("touchmove",function(a){a.preventDefault()});window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
$(document).ready(function(){function a(a){0!=Math.floor(e)&&!f&&k>m&&k<n?(e+=t,k+=e,fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(k,d.transY,fretboardZoomRate)),requestAnimationFrame(arguments.callee)):k>n?(d=getMatrix(fretboard.css(Modernizr.prefixed("transform"))),fretboard.addClass("transition"),fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(n,d.transY,fretboardZoomRate)),tuningControl.removeClass("hide")):
k<m&&(d=getMatrix(fretboard.css(Modernizr.prefixed("transform"))),fretboard.addClass("transition"),fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(m,d.transY,fretboardZoomRate)),tuningControl.addClass("hide"))}checkIsMobile()&&setTimeout(scrollTo,100,0,1);fretboard=$(".fretboard:first");tuningControl=$(".tuning-control:first");fretboard.empty();var b="C C# D D# E F F# G G# A A# B".split(" "),g="EADGBE".split("");g.reverse();for(var p=$('<div class="frets"></div>'),
c=0;24>=c;c++){var l;l=$('<div class="fret fret-{0}"></div>'.format(c));3==c||5==c||7==c||9==c||15==c||17==c||19==c||21==c?l.append('<div class="dot"></div>'):(12==c||24==c)&&l.append('<div class="double-dot"></div><div class="double-dot"></div>');p.append(l)}fretboard.append(p);p=$('<div class="strings"></div>');for(c=1;6>=c;c++){for(var u=$('<div class="string string-{0}"></div>'.format(c)),y=b.indexOf(g[c-1]),q=0;24>=q;q++){l=$('<div class="fret fret-{0}"></div>'.format(q));var r=b[(y+q)%b.length],
r=$('<div class="note note-{1}">{0}</div>'.format(r,r.replace("#","S")));l.append(r);u.append(l)}p.append(u)}fretboard.append(p);var v=$(".control .selected-root"),h=$(".root-list");v.bind("click touchstart",function(a){a.preventDefault();h.hasClass("visible")?h.removeClass("visible"):(h.addClass("visible"),j.removeClass("visible"))});h.bind("click touchstart",function(a){a.preventDefault();-1!=a.target.className.indexOf("note")&&(selectedRootNote=a.target.textContent,s(selectedRootNote,selectedScaleInterval,
null))});h.find(".close-button").bind("click touchstart",function(){h.removeClass("visible")});var w=$(".control .selected-scale"),j=$(".scale-list");w.bind("click touchstart",function(a){a.preventDefault();j.hasClass("visible")?j.removeClass("visible"):(h.removeClass("visible"),j.addClass("visible"))});j.bind("click touchstart",function(a){a.preventDefault();var b=$(a.target).data("interval");b&&(selectedScaleInterval=b,s(selectedRootNote,selectedScaleInterval,a.target.textContent))});j.find(".close-button").bind("click touchstart",
function(){j.removeClass("visible")});var s=function(a,c,g){v.html("<div>{0}</div>".format(a));h.find(".note").removeClass("selected");h.find(".note-{0}".format(a.replace("#","S"))).addClass("selected");g&&(w.html("{0}".format(g)),j.find("li").removeClass("selected"),j.find("li").filter(function(){return $(this).text()==g}).addClass("selected"));var d=$(".fretboard .note");d.removeClass("root");d.removeClass("not-scale");$(".fretboard .note-{0}".format(a.replace("#","S"))).addClass("root");d=[];d[0]=
a;var e=b.indexOf(a),f=0;for(a=0;a<c.length;a++)f+=c[a],d[a+1]=b[(e+f)%b.length];for(a=0;a<b.length;a++)c=b[a],d.contains(c)||$(".fretboard .note-{0}".format(c.replace("#","S"))).addClass("not-scale")};s(selectedRootNote,selectedScaleInterval,"Major");fretboard.bind("dblclick",function(a){a.preventDefault();fretboardZoomRate=a.shiftKey?a.altKey?fretboardZoomRate-0.1:fretboardZoomRate-0.5:a.altKey?fretboardZoomRate+0.1:fretboardZoomRate+0.5;0.25>fretboardZoomRate&&(fretboardZoomRate=0.25);2<fretboardZoomRate&&
(fretboardZoomRate=2);fretboard.hasClass("transition")||fretboard.addClass("transition");a=getMatrix(fretboard.css(Modernizr.prefixed("transform")));fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(a.transX,a.transY,fretboardZoomRate))});$(document).bind("mousewheel",function(a,b){a.preventDefault();fretboard.hasClass("transition")&&fretboard.removeClass("transition");fretboardZoomRate+=b/100;fretboardZoomRate*=10;fretboardZoomRate=Math.round(fretboardZoomRate);
fretboardZoomRate/=10;0.25>fretboardZoomRate&&(fretboardZoomRate=0.25);2<fretboardZoomRate&&(fretboardZoomRate=2);var c=getMatrix(fretboard.css(Modernizr.prefixed("transform")));fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(c.transX,c.transY,fretboardZoomRate))});var d=getMatrix(fretboard.css(Modernizr.prefixed("transform"))),k=d.transX,e=1,t=1,m=-fretboard.outerWidth()+getDocumentSize().x-110,n=0,f,x;fretboard.bind("mousedown touchstart",function(){f=
getPoint(event);x=Date.now();fretboard.removeClass("transition");startMatrix=getMatrix(fretboard.css(Modernizr.prefixed("transform")))});$(document).bind("mousemove touchmove",function(){if(!(event.touches&&1<event.touches.length)){var a=getPoint(event);if(f){var a=a.x-f.x,a=parseInt(startMatrix.transX)+a,b=startMatrix.transY,c=getMatrix(fretboard.css(Modernizr.prefixed("transform")));fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{3})".format(a,b,c.scaleX,c.scaleY));
-10>a?tuningControl.addClass("hide"):tuningControl.removeClass("hide")}}});$(document).bind("mouseup touchend",function(){if(f)if(event.touches&&0<event.touches.length)f=getPoint(event);else{var b=getPoint(event).x-f.x,c=Date.now()-x;f=null;m=-(fretboard.outerWidth()*fretboardZoomRate)+getDocumentSize().x-110;d=getMatrix(fretboard.css(Modernizr.prefixed("transform")));d.transX>n?(fretboard.addClass("transition"),fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(n,
d.transY,fretboardZoomRate))):d.transX<m?(fretboard.addClass("transition"),fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(m,d.transY,fretboardZoomRate))):(e=b/(c/10),e=Math.round(e),300<c&&(e=0),30<e&&(e=30),k=d.transX,t=0<b?-0.5:0.5,requestAnimationFrame(a))}});tweetCount($("#header div.twitter .sns-count-bubble"),"http://guitar-scale.heavymery.net/");likeCount($("#header div.facebook .sns-count-bubble"),"http://guitar-scale.heavymery.net/")});
window.addEventListener("orientationchange",function(){});var resizeEventTimer;$(window).resize(function(){clearTimeout(resizeEventTimer);resizeEventTimer=setTimeout(function(){var a=-fretboard.outerWidth()+getDocumentSize().x-110,b=getMatrix(fretboard.css(Modernizr.prefixed("transform")));b.transX<a&&fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2},1)".format(a,b.transY,fretboardZoomRate))},100)});var startZoomRate=1;
window.addEventListener("gesturestart",function(){fretboard.hasClass("transition")&&fretboard.removeClass("transition");startZoomRate=fretboardZoomRate});
window.addEventListener("gesturechange",function(a){a.preventDefault();fretboardZoomRate=startZoomRate*a.scale;0.25>fretboardZoomRate&&(fretboardZoomRate=0.25);2<fretboardZoomRate&&(fretboardZoomRate=2);a=getMatrix(fretboard.css(Modernizr.prefixed("transform")));fretboard.css(Modernizr.prefixed("transform"),"translate3d({0}px,{1}px,0) scale({2},{2})".format(a.transX,a.transY,fretboardZoomRate))});
var touchstartHandler=function(){$(this).attr("touchstarted","true");$(this).attr("touchmoved","false")},touchmoveHandler=function(){$(this).attr("touchmoved","true")},touchendHandler=function(a,b){"true"!=a.target.attr("touchmoved")&&b()},parseRSS=function(a,b,g){$.ajax({url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num="+b+"&callback=?&q="+encodeURIComponent(a),dataType:"json",success:function(a){g(a.responseData.feed)}})},tweetCount=function(a,b){a&&$.ajax({type:"GET",
url:"http://urls.api.twitter.com/1/urls/count.json",data:{url:encodeURI(b?b:location.href),noncache:new Date},dataType:"jsonp",success:function(b){a.text(b.count)}})},likeCount=function(a,b){a&&$.ajax({type:"GET",url:"http://graph.facebook.com/"+(b?b:location.href),dataType:"jsonp",success:function(b){a.text(b.shares?b.shares:0)}})},hatebuCount=function(a,b){a&&$.ajax({type:"GET",url:"http://api.b.st-hatena.com/entry.count",data:{url:b?b:location.href},dataType:"jsonp",success:function(b){a.text(b?
b:0)}})},userAgent=window.navigator.userAgent.toLowerCase(),appVersion=window.navigator.appVersion.toLowerCase(),isOpera=userAgent.indexOf("opera")+1?1:0,isSafari=appVersion.indexOf("safari")+1?1:0,getScreenSize=function(){var a={};!isSafari&&!isOpera?(a.x=document.documentElement.clientWidth||document.body.clientWidth||document.body.scrollWidth,a.y=document.documentElement.clientHeight||document.body.clientHeight||document.body.scrollHeight):(a.x=window.innerWidth,a.y=window.innerHeight);a.mx=parseInt(a.x/
2);a.my=parseInt(a.y/2);a.toString=function(){return this.x+"x"+this.y+"(min-"+this.mx+"x"+this.my+")"};return a};function getDocumentSize(){var a={};a.x=document.documentElement.scrollWidth||document.body.scrollWidth;a.y=document.documentElement.scrollHeight||document.body.scrollHeight;a.toString=function(){return this.x+"x"+this.y};return a}
function getScrollPosition(){var a={};a.x=document.documentElement.scrollLeft||document.body.scrollLeft;a.y=document.documentElement.scrollTop||document.body.scrollTop;a.toString=function(){return this.x+"x"+this.y};return a}
var getBrowserName=function(){if(-1!=userAgent.indexOf("opera"))return"opera";if(-1!=userAgent.indexOf("msie"))return-1!=appVersion.indexOf("msie 6.")?"ie6":-1!=appVersion.indexOf("msie 7.")?"ie7":-1!=appVersion.indexOf("msie 8.")?"ie8":-1!=appVersion.indexOf("msie 9.")?"ie9":"ie";if(-1!=userAgent.indexOf("chrome"))return"chrome";if(-1!=userAgent.indexOf("safari"))return"safari";if(-1!=userAgent.indexOf("gecko"))return"gecko"},checkIsMobile=function(){return 0<userAgent.indexOf("iphone")&&-1==userAgent.indexOf("ipad")||
0<userAgent.indexOf("ipod")||0<userAgent.indexOf("android")?!0:!1},scrollToTop=function(){$("body , html").animate({scrollTop:0},"normal","easeOutQuad")},openPopupWindow=function(a,b,g){window.open(a,"_blank","toolbar=0,location=0,menubar=0,"+"width={0},height={1},left={2},top={3}".format(b,g,Number((window.screen.width-b)/2),Number((window.screen.height-g)/2)))},getPoint=function(a){return-1!=a.type.indexOf("touch")?a.touches&&0<a.touches.length?{x:a.touches[0].pageX,y:a.touches[0].pageY}:{x:a.changedTouches[0].pageX,
y:a.changedTouches[0].pageY}:{x:a.pageX,y:a.pageY}},getMatrix=function(a){a=a.substr(7,a.length-8).split(", ");return 6==a.length?{transX:parseFloat(a[4]),transY:parseFloat(a[5]),scaleX:parseFloat(a[0]),scaleY:parseFloat(a[3]),screwX:parseFloat(a[1]),screwY:parseFloat(a[2])}:{transX:parseFloat(a[12]),transY:parseFloat(a[13]),transZ:parseFloat(a[14]),scaleX:parseFloat(a[0]),scaleY:parseFloat(a[5]),scaleZ:parseFloat(a[10]),screwX:parseFloat(a[1]),screwY:parseFloat(a[4])}};
